bases:
  - ./../tezos-remote-signer-loadbalancer-base

nameSuffix: -${custname}

imageTags:
  - name: tezos-remote-signer-loadbalancer
    newName: gcr.io/${project}/tezos-remote-signer-loadbalancer
    newTag: ${kubernetes_namespace}-latest

configMapGenerator:
- name: tezos-remote-signer-loadbalancer-configmap
  literals:
  - PUBLIC_BAKING_KEY="${baking_nodes[nodename][custname]["public_baking_key"]}"
  - LEDGER_AUTHORIZED_PATH="${baking_nodes[nodename][custname]["ledger_authorized_path"]}"
  - SIGNER_A_PORT="${baking_nodes[nodename][custname]["authorized_signers"][0]["signer_port"]}"
%{ if length(baking_nodes[nodename][custname]["authorized_signers"]) > 1 }
  - SIGNER_B_PORT="${element(baking_nodes[nodename][custname]["authorized_signers"],1)["signer_port"]}"
%{endif}
